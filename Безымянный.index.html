import logging
import random
from telegram import Update
from telegram.ext import Application, CommandHandler, ContextTypes

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏
TOKEN = "7964522861:AAFm_Jpudwz2uBOKZ3bebn0mjgXb3wPgD3I"

# –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤
players = {}

logging.basicConfig(level=logging.INFO)

def get_player_data(user_id):
    if user_id not in players:
        players[user_id] = {
            'health': 100,
            'hunger': 0,
            'thirst': 0,
            'day': 1,
            'inventory': [],
            'location': '–õ–µ—Å'
        }
    return players[user_id]

async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.effective_user.id
    player = get_player_data(user_id)
    
    await update.message.reply_text(
        f"üåç –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∏–≥—Ä—É –Ω–∞ –≤—ã–∂–∏–≤–∞–Ω–∏–µ, {update.effective_user.first_name}!\n\n"
        f"üìç –í–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ: {player['location']}\n"
        f"‚ù§Ô∏è –ó–¥–æ—Ä–æ–≤—å–µ: {player['health']}%\n"
        f"üçñ –ì–æ–ª–æ–¥: {player['hunger']}%\n"
        f"üíß –ñ–∞–∂–¥–∞: {player['thirst']}%\n"
        f"üìÖ –î–µ–Ω—å: {player['day']}\n\n"
        "üîß –ö–æ–º–∞–Ω–¥—ã:\n"
        "/explore - –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—é\n"
        "/hunt - –û—Ö–æ—Ç–∏—Ç—å—Å—è\n"
        "/drink - –ù–∞–π—Ç–∏ –≤–æ–¥—É\n"
        "/stats - –ú–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n"
        "/rest - –û—Ç–¥–æ—Ö–Ω—É—Ç—å\n"
        "/inventory - –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å"
    )

async def explore(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.effective_user.id
    player = get_player_data(user_id)
    
    events = [
        "–í—ã –Ω–∞—à–ª–∏ —è–≥–æ–¥—ã! +10 –∫ —Å—ã—Ç–æ—Å—Ç–∏",
        "–í—ã –≤—Å—Ç—Ä–µ—Ç–∏–ª–∏ –¥–∏–∫–æ–≥–æ –∑–≤–µ—Ä—è! -20 –∑–¥–æ—Ä–æ–≤—å—è",
        "–í—ã –Ω–∞—à–ª–∏ —Ä—É—á–µ–π. +30 –∫ –∂–∞–∂–¥–µ",
        "–ù–∏—á–µ–≥–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–≥–æ –Ω–µ –ø—Ä–æ–∏–∑–æ—à–ª–æ",
        "–í—ã –Ω–∞—à–ª–∏ –∑–∞–±—Ä–æ—à–µ–Ω–Ω—É—é —Ö–∏–∂–∏–Ω—É",
        "–í—ã –∑–∞–±–ª—É–¥–∏–ª–∏—Å—å –≤ –ª–µ—Å—É"
    ]
    
    event = random.choice(events)
    player['day'] += 1
    player['hunger'] += 10
    player['thirst'] += 15
    
    await update.message.reply_text(
        f"üîç –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è:\n{event}\n\n"
        f"üìÖ –ü—Ä–æ—à–µ–ª –¥–µ–Ω—å. –¢–µ–ø–µ—Ä—å –¥–µ–Ω—å {player['day']}\n"
        f"üçñ –ì–æ–ª–æ–¥: +10% ({player['hunger']}%)\n"
        f"üíß –ñ–∞–∂–¥–∞: +15% ({player['thirst']}%)"
    )

async def stats(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.effective_user.id
    player = get_player_data(user_id)
    
    await update.message.reply_text(
        f"üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ {update.effective_user.first_name}:\n"
        f"‚ù§Ô∏è –ó–¥–æ—Ä–æ–≤—å–µ: {player['health']}%\n"
        f"üçñ –ì–æ–ª–æ–¥: {player['hunger']}%\n"
        f"üíß –ñ–∞–∂–¥–∞: {player['thirst']}%\n"
        f"üìÖ –î–µ–Ω—å: {player['day']}\n"
        f"üìç –õ–æ–∫–∞—Ü–∏—è: {player['location']}"
    )

async def hunt(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.effective_user.id
    player = get_player_data(user_id)
    
    success = random.choice([True, True, False])
    if success:
        player['hunger'] = max(0, player['hunger'] - 30)
        await update.message.reply_text("üéØ –í—ã –ø–æ–π–º–∞–ª–∏ –∫—Ä–æ–ª–∏–∫–∞! -30% –∫ –≥–æ–ª–æ–¥—É")
    else:
        player['health'] -= 10
        await update.message.reply_text("üê∫ –ù–∞ –≤–∞—Å –Ω–∞–ø–∞–ª –≤–æ–ª–∫! -10 –∑–¥–æ—Ä–æ–≤—å—è")

async def drink(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.effective_user.id
    player = get_player_data(user_id)
    
    player['thirst'] = max(0, player['thirst'] - 40)
    await update.message.reply_text("üíß –í—ã –Ω–∞–ø–∏–ª–∏—Å—å —á–∏—Å—Ç–æ–π –≤–æ–¥—ã! -40% –∫ –∂–∞–∂–¥–µ")

async def rest(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.effective_user.id
    player = get_player_data(user_id)
    
    player['health'] = min(100, player['health'] + 20)
    player['day'] += 1
    await update.message.reply_text("üõå –í—ã –æ—Ç–¥–æ—Ö–Ω—É–ª–∏! +20 –∑–¥–æ—Ä–æ–≤—å—è, –ø—Ä–æ—à–µ–ª 1 –¥–µ–Ω—å")

async def inventory(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.effective_user.id
    player = get_player_data(user_id)
    
    if player['inventory']:
        items = "\n".join(player['inventory'])
        await update.message.reply_text(f"üéí –í–∞—à –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å:\n{items}")
    else:
        await update.message.reply_text("üéí –í–∞—à –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç")

def main():
    application = Application.builder().token(TOKEN).build()
    
    application.add_handler(CommandHandler("start", start))
    application.add_handler(CommandHandler("explore", explore))
    application.add_handler(CommandHandler("stats", stats))
    application.add_handler(CommandHandler("hunt", hunt))
    application.add_handler(CommandHandler("drink", drink))
    application.add_handler(CommandHandler("rest", rest))
    application.add_handler(CommandHandler("inventory", inventory))
    
    application.run_polling()

if __name__ == "__main__":
    main()